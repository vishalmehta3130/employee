!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports,require("@angular/core"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("angular-notifier",["exports","@angular/core","rxjs","@angular/common"],i):i((t=t||self)["angular-notifier"]={},t.ng.core,t.rxjs,t.ng.common)}(this,(function(t,i,o,n){"use strict";var e=function(t){this.template=null,Object.assign(this,t),void 0===t.id&&(this.id="ID_"+(new Date).getTime())};var s=function(){function t(){this.actionStream=new o.Subject,this.actionQueue=[],this.isActionInProgress=!1}return t.prototype.push=function(t){this.actionQueue.push(t),this.tryToRunNextAction()},t.prototype.continue=function(){this.isActionInProgress=!1,this.tryToRunNextAction()},t.prototype.tryToRunNextAction=function(){this.isActionInProgress||0===this.actionQueue.length||(this.isActionInProgress=!0,this.actionStream.next(this.actionQueue.shift()))},t.decorators=[{type:i.Injectable}],t.ctorParameters=function(){return[]},t}();var a=function(t){void 0===t&&(t={}),this.animations={enabled:!0,hide:{easing:"ease",offset:50,preset:"fade",speed:300},overlap:150,shift:{easing:"ease",speed:300},show:{easing:"ease",preset:"slide",speed:300}},this.behaviour={autoHide:7e3,onClick:!1,onMouseover:"pauseAutoHide",showDismissButton:!0,stacking:4},this.position={horizontal:{distance:12,position:"left"},vertical:{distance:12,gap:10,position:"bottom"}},this.theme="material",void 0!==t.theme&&(this.theme=t.theme),void 0!==t.animations&&(void 0!==t.animations.enabled&&(this.animations.enabled=t.animations.enabled),void 0!==t.animations.overlap&&(this.animations.overlap=t.animations.overlap),void 0!==t.animations.hide&&Object.assign(this.animations.hide,t.animations.hide),void 0!==t.animations.shift&&Object.assign(this.animations.shift,t.animations.shift),void 0!==t.animations.show&&Object.assign(this.animations.show,t.animations.show)),void 0!==t.behaviour&&Object.assign(this.behaviour,t.behaviour),void 0!==t.position&&(void 0!==t.position.horizontal&&Object.assign(this.position.horizontal,t.position.horizontal),void 0!==t.position.vertical&&Object.assign(this.position.vertical,t.position.vertical))};var r=new i.InjectionToken("[angular-notifier] Notifier Options"),c=new i.InjectionToken("[anuglar-notifier] Notifier Config"),f=function(){function t(t,i){this.queueService=t,this.config=i}return t.prototype.getConfig=function(){return this.config},t.prototype.show=function(t){this.queueService.push({payload:t,type:"SHOW"})},t.prototype.hide=function(t){this.queueService.push({payload:t,type:"HIDE"})},t.prototype.hideNewest=function(){this.queueService.push({type:"HIDE_NEWEST"})},t.prototype.hideOldest=function(){this.queueService.push({type:"HIDE_OLDEST"})},t.prototype.hideAll=function(){this.queueService.push({type:"HIDE_ALL"})},t.prototype.notify=function(t,i,o){var n={message:i,type:t};void 0!==o&&(n.id=o),this.show(n)},t.decorators=[{type:i.Injectable}],t.ctorParameters=function(){return[{type:s},{type:a,decorators:[{type:i.Inject,args:[c]}]}]},t}();var h=function(){function t(t,i,o){var n=this;this.changeDetector=t,this.queueService=i,this.config=o.getConfig(),this.notifications=[],this.queueServiceSubscription=this.queueService.actionStream.subscribe((function(t){n.handleAction(t).then((function(){n.queueService.continue()}))}))}return t.prototype.ngOnDestroy=function(){this.queueServiceSubscription&&this.queueServiceSubscription.unsubscribe()},t.prototype.identifyNotification=function(t,i){return i.id},t.prototype.onNotificationDismiss=function(t){this.queueService.push({payload:t,type:"HIDE"})},t.prototype.onNotificationReady=function(t){var i=this.notifications[this.notifications.length-1];i.component=t,this.continueHandleShowAction(i)},t.prototype.handleAction=function(t){switch(t.type){case"SHOW":return this.handleShowAction(t);case"HIDE":return this.handleHideAction(t);case"HIDE_OLDEST":return this.handleHideOldestAction(t);case"HIDE_NEWEST":return this.handleHideNewestAction(t);case"HIDE_ALL":return this.handleHideAllAction(t);default:return new Promise((function(t,i){t()}))}},t.prototype.handleShowAction=function(t){var i=this;return new Promise((function(o,n){i.tempPromiseResolver=o,i.addNotificationToList(new e(t.payload))}))},t.prototype.continueHandleShowAction=function(t){var i=this,o=this.notifications.length;if(1===o)t.component.show().then(this.tempPromiseResolver);else{if(!1===this.config.behaviour.stacking||this.config.behaviour.stacking<2)this.notifications[0].component.hide().then((function(){i.removeNotificationFromList(i.notifications[0]),t.component.show().then(i.tempPromiseResolver)}));else{var n=[];if(o>this.config.behaviour.stacking){var e=this.notifications.slice(1,o-1);this.config.animations.enabled?!1!==this.config.animations.overlap&&this.config.animations.overlap>0?(n.push(this.notifications[0].component.hide()),setTimeout((function(){n.push(i.shiftNotifications(e,t.component.getHeight(),!0))}),this.config.animations.hide.speed-this.config.animations.overlap),setTimeout((function(){n.push(t.component.show())}),this.config.animations.hide.speed+this.config.animations.shift.speed-this.config.animations.overlap)):n.push(new Promise((function(o,n){i.notifications[0].component.hide().then((function(){i.shiftNotifications(e,t.component.getHeight(),!0).then((function(){t.component.show().then(o)}))}))}))):(n.push(this.notifications[0].component.hide()),n.push(this.shiftNotifications(e,t.component.getHeight(),!0)),n.push(t.component.show()))}else{var s=this.notifications.slice(0,o-1);this.config.animations.enabled?!1!==this.config.animations.overlap&&this.config.animations.overlap>0?(n.push(this.shiftNotifications(s,t.component.getHeight(),!0)),setTimeout((function(){n.push(t.component.show())}),this.config.animations.shift.speed-this.config.animations.overlap)):n.push(new Promise((function(o,n){i.shiftNotifications(s,t.component.getHeight(),!0).then((function(){t.component.show().then(o)}))}))):(n.push(this.shiftNotifications(s,t.component.getHeight(),!0)),n.push(t.component.show()))}Promise.all(n).then((function(){o>i.config.behaviour.stacking&&i.removeNotificationFromList(i.notifications[0]),i.tempPromiseResolver()}))}}},t.prototype.handleHideAction=function(t){var i=this;return new Promise((function(o,n){var e=[],s=i.findNotificationById(t.payload);if(void 0!==s){var a=i.findNotificationIndexById(t.payload);if(void 0!==a){var r=i.notifications.slice(0,a);r.length>0?i.config.animations.enabled&&i.config.animations.hide.speed>0?!1!==i.config.animations.overlap&&i.config.animations.overlap>0?(e.push(s.component.hide()),setTimeout((function(){e.push(i.shiftNotifications(r,s.component.getHeight(),!1))}),i.config.animations.hide.speed-i.config.animations.overlap)):s.component.hide().then((function(){e.push(i.shiftNotifications(r,s.component.getHeight(),!1))})):(e.push(s.component.hide()),e.push(i.shiftNotifications(r,s.component.getHeight(),!1))):e.push(s.component.hide()),Promise.all(e).then((function(){i.removeNotificationFromList(s),o()}))}else o()}else o()}))},t.prototype.handleHideOldestAction=function(t){return 0===this.notifications.length?new Promise((function(t,i){t()})):(t.payload=this.notifications[0].id,this.handleHideAction(t))},t.prototype.handleHideNewestAction=function(t){return 0===this.notifications.length?new Promise((function(t,i){t()})):(t.payload=this.notifications[this.notifications.length-1].id,this.handleHideAction(t))},t.prototype.handleHideAllAction=function(t){var i=this;return new Promise((function(t,o){var n=i.notifications.length;if(0!==n)if(i.config.animations.enabled&&i.config.animations.hide.speed>0&&!1!==i.config.animations.hide.offset&&i.config.animations.hide.offset>0)for(var e=function(o){var e="top"===i.config.position.vertical.position?n-1:o;setTimeout((function(){i.notifications[o].component.hide().then((function(){("top"===i.config.position.vertical.position&&0===o||"bottom"===i.config.position.vertical.position&&o===n-1)&&(i.removeAllNotificationsFromList(),t())}))}),i.config.animations.hide.offset*e)},s=n-1;s>=0;s--)e(s);else{var a=[];for(s=n-1;s>=0;s--)a.push(i.notifications[s].component.hide());Promise.all(a).then((function(){i.removeAllNotificationsFromList(),t()}))}else t()}))},t.prototype.shiftNotifications=function(t,i,o){return new Promise((function(n,e){if(0!==t.length){for(var s=[],a=t.length-1;a>=0;a--)s.push(t[a].component.shift(i,o));Promise.all(s).then(n)}else n()}))},t.prototype.addNotificationToList=function(t){this.notifications.push(t),this.changeDetector.markForCheck()},t.prototype.removeNotificationFromList=function(t){this.notifications=this.notifications.filter((function(i){return i.component!==t.component})),this.changeDetector.markForCheck()},t.prototype.removeAllNotificationsFromList=function(){this.notifications=[],this.changeDetector.markForCheck()},t.prototype.findNotificationById=function(t){return this.notifications.find((function(i){return i.id===t}))},t.prototype.findNotificationIndexById=function(t){var i=this.notifications.findIndex((function(i){return i.id===t}));return-1!==i?i:void 0},t.decorators=[{type:i.Component,args:[{changeDetection:i.ChangeDetectionStrategy.OnPush,host:{class:"notifier__container"},selector:"notifier-container",template:'<ul>\n\t<li class="notifier__container-list" *ngFor="let notification of notifications; trackBy: identifyNotification;">\n\t\t<notifier-notification\n\t\t\t[notification]="notification"\n\t\t\t(ready)="onNotificationReady( $event )"\n\t\t\t(dismiss)="onNotificationDismiss( $event )">\n\t\t</notifier-notification>\n\t</li>\n</ul>\n'}]}],t.ctorParameters=function(){return[{type:i.ChangeDetectorRef},{type:s},{type:f}]},t}();var p={hide:function(){return{from:{opacity:"1"},to:{opacity:"0"}}},show:function(){return{from:{opacity:"0"},to:{opacity:"1"}}}},u={hide:function(t){var i,o,n=t.component.getConfig(),e=t.component.getShift();if("left"===n.position.horizontal.position)i={transform:"translate3d( 0, "+e+"px, 0 )"},o={transform:"translate3d( calc( -100% - "+n.position.horizontal.distance+"px - 10px ), "+e+"px, 0 )"};else if("right"===n.position.horizontal.position)i={transform:"translate3d( 0, "+e+"px, 0 )"},o={transform:"translate3d( calc( 100% + "+n.position.horizontal.distance+"px + 10px ), "+e+"px, 0 )"};else{i={transform:"translate3d( -50%, "+e+"px, 0 )"},o={transform:"translate3d( -50%, "+("top"===n.position.vertical.position?"calc( -100% - "+n.position.horizontal.distance+"px - 10px )":"calc( 100% + "+n.position.horizontal.distance+"px + 10px )")+", 0 )"}}return{from:i,to:o}},show:function(t){var i,o,n=t.component.getConfig();if("left"===n.position.horizontal.position)i={transform:"translate3d( calc( -100% - "+n.position.horizontal.distance+"px - 10px ), 0, 0 )"},o={transform:"translate3d( 0, 0, 0 )"};else if("right"===n.position.horizontal.position)i={transform:"translate3d( calc( 100% + "+n.position.horizontal.distance+"px + 10px ), 0, 0 )"},o={transform:"translate3d( 0, 0, 0 )"};else{i={transform:"translate3d( -50%, "+("top"===n.position.vertical.position?"calc( -100% - "+n.position.horizontal.distance+"px - 10px )":"calc( 100% + "+n.position.horizontal.distance+"px + 10px )")+", 0 )"},o={transform:"translate3d( -50%, 0, 0 )"}}return{from:i,to:o}}},m=function(){function t(){this.animationPresets={fade:p,slide:u}}return t.prototype.getAnimationData=function(t,i){var o,n,e;return"show"===t?(o=this.animationPresets[i.component.getConfig().animations.show.preset].show(i),n=i.component.getConfig().animations.show.speed,e=i.component.getConfig().animations.show.easing):(o=this.animationPresets[i.component.getConfig().animations.hide.preset].hide(i),n=i.component.getConfig().animations.hide.speed,e=i.component.getConfig().animations.hide.easing),{keyframes:[o.from,o.to],options:{duration:n,easing:e,fill:"forwards"}}},t.decorators=[{type:i.Injectable}],t.ctorParameters=function(){return[]},t}();var l=function(){function t(){this.now=0,this.remaining=0}return t.prototype.start=function(t){var i=this;return new Promise((function(o,n){i.remaining=t,i.finishPromiseResolver=o,i.continue()}))},t.prototype.pause=function(){clearTimeout(this.timerId),this.remaining-=(new Date).getTime()-this.now},t.prototype.continue=function(){var t=this;this.now=(new Date).getTime(),this.timerId=window.setTimeout((function(){t.finish()}),this.remaining)},t.prototype.stop=function(){clearTimeout(this.timerId),this.remaining=0},t.prototype.finish=function(){this.finishPromiseResolver()},t.decorators=[{type:i.Injectable}],t.ctorParameters=function(){return[]},t}();var d=function(){function t(t,o,n,e,s){this.config=n.getConfig(),this.ready=new i.EventEmitter,this.dismiss=new i.EventEmitter,this.timerService=e,this.animationService=s,this.renderer=o,this.element=t.nativeElement,this.elementShift=0}return t.prototype.ngAfterViewInit=function(){this.setup(),this.elementHeight=this.element.offsetHeight,this.elementWidth=this.element.offsetWidth,this.ready.emit(this)},t.prototype.getConfig=function(){return this.config},t.prototype.getHeight=function(){return this.elementHeight},t.prototype.getWidth=function(){return this.elementWidth},t.prototype.getShift=function(){return this.elementShift},t.prototype.show=function(){var t=this;return new Promise((function(i,o){if(t.config.animations.enabled&&t.config.animations.show.speed>0){for(var n=t.animationService.getAnimationData("show",t.notification),e=Object.keys(n.keyframes[0]),s=e.length-1;s>=0;s--)t.renderer.setStyle(t.element,e[s],n.keyframes[0][e[s]]);t.renderer.setStyle(t.element,"visibility","visible"),t.element.animate(n.keyframes,n.options).onfinish=function(){t.startAutoHideTimer(),i()}}else t.renderer.setStyle(t.element,"visibility","visible"),t.startAutoHideTimer(),i()}))},t.prototype.hide=function(){var t=this;return new Promise((function(i,o){if(t.stopAutoHideTimer(),t.config.animations.enabled&&t.config.animations.hide.speed>0){var n=t.animationService.getAnimationData("hide",t.notification);t.element.animate(n.keyframes,n.options).onfinish=function(){i()}}else i()}))},t.prototype.shift=function(t,i){var o=this;return new Promise((function(n,e){var s;s="top"===o.config.position.vertical.position&&i||"bottom"===o.config.position.vertical.position&&!i?o.elementShift+t+o.config.position.vertical.gap:o.elementShift-t-o.config.position.vertical.gap;var a="middle"===o.config.position.horizontal.position?"-50%":"0";if(o.config.animations.enabled&&o.config.animations.shift.speed>0){var r={keyframes:[{transform:"translate3d( "+a+", "+o.elementShift+"px, 0 )"},{transform:"translate3d( "+a+", "+s+"px, 0 )"}],options:{duration:o.config.animations.shift.speed,easing:o.config.animations.shift.easing,fill:"forwards"}};o.elementShift=s,o.element.animate(r.keyframes,r.options).onfinish=function(){n()}}else o.renderer.setStyle(o.element,"transform","translate3d( "+a+", "+s+"px, 0 )"),o.elementShift=s,n()}))},t.prototype.onClickDismiss=function(){this.dismiss.emit(this.notification.id)},t.prototype.onNotificationMouseover=function(){"pauseAutoHide"===this.config.behaviour.onMouseover?this.pauseAutoHideTimer():"resetAutoHide"===this.config.behaviour.onMouseover&&this.stopAutoHideTimer()},t.prototype.onNotificationMouseout=function(){"pauseAutoHide"===this.config.behaviour.onMouseover?this.continueAutoHideTimer():"resetAutoHide"===this.config.behaviour.onMouseover&&this.startAutoHideTimer()},t.prototype.onNotificationClick=function(){"hide"===this.config.behaviour.onClick&&this.onClickDismiss()},t.prototype.startAutoHideTimer=function(){var t=this;!1!==this.config.behaviour.autoHide&&this.config.behaviour.autoHide>0&&this.timerService.start(this.config.behaviour.autoHide).then((function(){t.onClickDismiss()}))},t.prototype.pauseAutoHideTimer=function(){!1!==this.config.behaviour.autoHide&&this.config.behaviour.autoHide>0&&this.timerService.pause()},t.prototype.continueAutoHideTimer=function(){!1!==this.config.behaviour.autoHide&&this.config.behaviour.autoHide>0&&this.timerService.continue()},t.prototype.stopAutoHideTimer=function(){!1!==this.config.behaviour.autoHide&&this.config.behaviour.autoHide>0&&this.timerService.stop()},t.prototype.setup=function(){"left"===this.config.position.horizontal.position?this.renderer.setStyle(this.element,"left",this.config.position.horizontal.distance+"px"):"right"===this.config.position.horizontal.position?this.renderer.setStyle(this.element,"right",this.config.position.horizontal.distance+"px"):(this.renderer.setStyle(this.element,"left","50%"),this.renderer.setStyle(this.element,"transform","translate3d( -50%, 0, 0 )")),"top"===this.config.position.vertical.position?this.renderer.setStyle(this.element,"top",this.config.position.vertical.distance+"px"):this.renderer.setStyle(this.element,"bottom",this.config.position.vertical.distance+"px"),this.renderer.addClass(this.element,"notifier__notification--"+this.notification.type),this.renderer.addClass(this.element,"notifier__notification--"+this.config.theme)},t.decorators=[{type:i.Component,args:[{changeDetection:i.ChangeDetectionStrategy.OnPush,host:{"(click)":"onNotificationClick()","(mouseout)":"onNotificationMouseout()","(mouseover)":"onNotificationMouseover()",class:"notifier__notification"},providers:[l],selector:"notifier-notification",template:'<ng-container *ngIf="notification.template; else predefinedNotification" [ngTemplateOutlet]="notification.template" [ngTemplateOutletContext]="{ notification: notification }">\n</ng-container>\n\n<ng-template #predefinedNotification>\n\t<p class="notifier__notification-message">{{ notification.message }}</p>\n\t<button class="notifier__notification-button" type="button" title="dismiss" *ngIf="config.behaviour.showDismissButton" (click)="onClickDismiss()">\n\t\t<svg class="notifier__notification-button-icon" viewBox="0 0 24 24" width="20" height="20">\n\t\t\t<path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />\n\t\t</svg>\n\t</button>\n</ng-template>\n'}]}],t.ctorParameters=function(){return[{type:i.ElementRef},{type:i.Renderer2},{type:f},{type:l},{type:m}]},t.propDecorators={notification:[{type:i.Input}],ready:[{type:i.Output}],dismiss:[{type:i.Output}]},t}();function g(t){return new a(t)}function v(){return new a({})}var y=function(){function t(){}return t.withConfig=function(i){return void 0===i&&(i={}),{ngModule:t,providers:[{provide:r,useValue:i},{deps:[r],provide:c,useFactory:g}]}},t.decorators=[{type:i.NgModule,args:[{declarations:[h,d],exports:[h],imports:[n.CommonModule],providers:[m,f,s,{provide:c,useFactory:v}]}]}],t}();t.NotifierConfig=a,t.NotifierConfigToken=c,t.NotifierContainerComponent=h,t.NotifierModule=y,t.NotifierNotificationComponent=d,t.NotifierOptionsToken=r,t.NotifierService=f,t.notifierCustomConfigFactory=g,t.notifierDefaultConfigFactory=v,t.ɵa=s,t.ɵb=l,t.ɵc=m,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-notifier.umd.min.js.map